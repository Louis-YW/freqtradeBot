{
  "id": "topic_5438996",
  "title": "Bitcoiner317",
  "author": "Bitcoiner317",
  "created_time": "February 09, 2023, 03:20:56 AM",
  "content": "I'm not too sure what I've done wrong. The node used to run fine but I've been experimenting with Ubuntu and new blocks aren't loading anymore. Might be due to updating my node from core v22 to v24. Anyway - can anybody spot a clue? Would be much appreciated! It seems like I'm not getting any connections for some reason.bitcoin.conf:   Code: datadir=/media/anonymous/T7/Bitcoin/        # Needed for full validation    addumevalid=0        #not needed but will show useful info later    #debug=net        server=1    txindex=1    daemon=1    rpcport=8332    rpcbind=0.0.0.0    rpcallowip=127.0.0.1    rpcallowip=10.0.0.0/8    rpcallowip=172.0.0.0/8    rpcallowip=192.0.0.0/8    zmqpubrawblock=tcp://0.0.0.0:28332    zmqpubrawtx=tcp://0.0.0.0:28333    zmqpubhashblock=tcp://0.0.0.0:28334    whitelist=127.0.0.1    rpcauth=****        proxy=127.0.0.1:9050    listen=1    bind=127.0.0.1    onlynet=oniondebug.log:Code:    2023-02-09T02:34:22Z Ignoring unknown configuration value addumevalid    2023-02-09T02:34:22Z Bitcoin Core version v24.0.1 (release build)    2023-02-09T02:34:22Z InitParameterInteraction: parameter interaction: -proxy set -> setting -upnp=0    2023-02-09T02:34:22Z InitParameterInteraction: parameter interaction: -proxy set -> setting -natpmp=0    2023-02-09T02:34:22Z InitParameterInteraction: parameter interaction: -proxy set -> setting -discover=0    2023-02-09T02:34:22Z InitParameterInteraction: parameter interaction: -onlynet excludes IPv4 and IPv6 -> setting -dnsseed=0    2023-02-09T02:34:22Z Using the 'sse4(1way),sse41(4way)' SHA256 implementation    2023-02-09T02:34:22Z Default data directory /home/anonymous/.bitcoin    2023-02-09T02:34:22Z Using data directory /media/anonymous/T7/Bitcoin    2023-02-09T02:34:22Z Config file: /home/anonymous/.bitcoin/bitcoin.conf    2023-02-09T02:34:22Z Config file arg: bind=\"127.0.0.1\"    2023-02-09T02:34:22Z Config file arg: daemon=\"1\"    2023-02-09T02:34:22Z Config file arg: datadir=\"/media/anonymous/T7/Bitcoin/\"    2023-02-09T02:34:22Z Config file arg: listen=\"1\"    2023-02-09T02:34:22Z Config file arg: onlynet=\"onion\"    2023-02-09T02:34:22Z Config file arg: proxy=\"127.0.0.1:9050\"    2023-02-09T02:34:22Z Config file arg: rpcallowip=\"127.0.0.1\"    2023-02-09T02:34:22Z Config file arg: rpcallowip=\"10.0.0.0/8\"    2023-02-09T02:34:22Z Config file arg: rpcallowip=\"172.0.0.0/8\"    2023-02-09T02:34:22Z Config file arg: rpcallowip=\"192.0.0.0/8\"    2023-02-09T02:34:22Z Config file arg: rpcauth=****    2023-02-09T02:34:22Z Config file arg: rpcbind=****    2023-02-09T02:34:22Z Config file arg: rpcport=\"8332\"    2023-02-09T02:34:22Z Config file arg: server=\"1\"    2023-02-09T02:34:22Z Config file arg: txindex=\"1\"    2023-02-09T02:34:22Z Config file arg: whitelist=\"127.0.0.1\"    2023-02-09T02:34:22Z Config file arg: zmqpubhashblock=\"tcp://0.0.0.0:28334\"    2023-02-09T02:34:22Z Config file arg: zmqpubrawblock=\"tcp://0.0.0.0:28332\"    2023-02-09T02:34:22Z Config file arg: zmqpubrawtx=\"tcp://0.0.0.0:28333\"    2023-02-09T02:34:22Z Command-line arg: conf=\"/home/anonymous/.bitcoin/bitcoin.conf\"    2023-02-09T02:34:22Z Command-line arg: daemon=\"\"    2023-02-09T02:34:22Z Command-line arg: datadir=\"/media/anonymous/T7/Bitcoin\"    2023-02-09T02:34:22Z Command-line arg: pid=\"/media/anonymous/T7/Bitcoin/bitcoind.pid\"    2023-02-09T02:34:22Z Using at most 125 automatic connections (1024 file descriptors available)    2023-02-09T02:34:23Z Using 16 MiB out of 16 MiB requested for signature cache, able to store 524288 elements    2023-02-09T02:34:23Z Using 16 MiB out of 16 MiB requested for script execution cache, able to store 524288 elements    2023-02-09T02:34:23Z Script verification uses 3 additional threads    2023-02-09T02:34:23Z scheduler thread start    2023-02-09T02:34:23Z WARNING: the RPC server is not safe to expose to untrusted networks such as the public internet    2023-02-09T02:34:23Z [http] creating work queue of depth 16    2023-02-09T02:34:23Z Using random cookie authentication.    2023-02-09T02:34:23Z Generated RPC authentication cookie /media/anonymous/T7/Bitcoin/.cookie    2023-02-09T02:34:23Z Using rpcauth authentication.    2023-02-09T02:34:23Z [http] starting 4 worker threads    2023-02-09T02:34:23Z Using wallet directory /media/anonymous/T7/Bitcoin    2023-02-09T02:34:23Z init message: Verifying wallet(s)…    2023-02-09T02:34:23Z Using /16 prefix for IP bucketing    2023-02-09T02:34:23Z init message: Loading P2P addresses…    2023-02-09T02:34:23Z Loaded 57414 addresses from peers.dat  608ms    2023-02-09T02:34:23Z init message: Loading banlist…    2023-02-09T02:34:23Z SetNetworkActive: true    2023-02-09T02:34:23Z Cache configuration:    2023-02-09T02:34:23Z * Using 2.0 MiB for block index database    2023-02-09T02:34:23Z * Using 56.0 MiB for transaction index database    2023-02-09T02:34:23Z * Using 8.0 MiB for chain state database    2023-02-09T02:34:23Z * Using 384.0 MiB for in-memory UTXO set (plus up to 286.1 MiB of unused mempool space)    2023-02-09T02:34:23Z init message: Loading block index…    2023-02-09T02:34:23Z Assuming ancestors of block 00000000000000000009c97098b5295f7e5f183ac811fb5d1534040adb93cabd have valid signatures.    2023-02-09T02:34:23Z Setting nMinimumChainWork=00000000000000000000000000000000000000003404ba0801921119f903495e    2023-02-09T02:34:23Z Switching active chainstate to Chainstate [ibd] @ height -1 (null)    2023-02-09T02:34:23Z Opening LevelDB in /media/anonymous/T7/Bitcoin/blocks/index    2023-02-09T02:34:23Z Opened LevelDB successfully    2023-02-09T02:34:23Z Using obfuscation key for /media/anonymous/T7/Bitcoin/blocks/index: 0000000000000000    2023-02-09T02:34:33Z LoadBlockIndexDB: last block file = 3277    2023-02-09T02:34:33Z LoadBlockIndexDB: last block file info: CBlockFileInfo(blocks=61, size=76919772, heights=763336...763446, time=2022-11-15...2022-11-16)    2023-02-09T02:34:33Z Checking all blk files are present...    2023-02-09T02:34:36Z Opening LevelDB in /media/anonymous/T7/Bitcoin/chainstate    2023-02-09T02:34:36Z Opened LevelDB successfully    2023-02-09T02:34:36Z Using obfuscation key for /media/anonymous/T7/Bitcoin/chainstate: 26573160958bad91    2023-02-09T02:34:36Z Loaded best chain: hashBestChain=00000000000000000004698262d70574cdfe6f8fbfa9f09f3289163c2d8c0c29 height=763398 date=2022-11-16T08:10:57Z progress=0.973287    2023-02-09T02:34:36Z init message: Verifying blocks…    2023-02-09T02:34:36Z Verifying last 6 blocks at level 3    2023-02-09T02:34:36Z [0%]...[16%]...[33%]...[50%]...[66%]...[83%]...[99%]...[DONE].    2023-02-09T02:34:38Z No coin database inconsistencies in last 6 blocks (8457 transactions)    2023-02-09T02:34:38Z  block index           14704ms    2023-02-09T02:34:38Z Opening LevelDB in /media/anonymous/T7/Bitcoin/indexes/txindex    2023-02-09T02:34:39Z Opened LevelDB successfully    2023-02-09T02:34:39Z Using obfuscation key for /media/anonymous/T7/Bitcoin/indexes/txindex: 0000000000000000    2023-02-09T02:34:39Z Setting NODE_NETWORK on non-prune mode    2023-02-09T02:34:39Z txindex thread start    2023-02-09T02:34:39Z txindex is enabled at height 763398    2023-02-09T02:34:39Z txindex thread exit    2023-02-09T02:34:39Z loadblk thread start    2023-02-09T02:34:39Z block tree size = 770107    2023-02-09T02:34:39Z nBestHeight = 763398    2023-02-09T02:34:39Z Imported mempool transactions from disk: 0 succeeded, 0 failed, 0 expired, 0 already there, 0 waiting for initial broadcast    2023-02-09T02:34:39Z loadblk thread exit    2023-02-09T02:34:39Z torcontrol thread start    2023-02-09T02:34:39Z Bound to 127.0.0.1:8333    2023-02-09T02:34:39Z Bound to 127.0.0.1:8334    2023-02-09T02:34:39Z Loaded 0 addresses from \"anchors.dat\"    2023-02-09T02:34:39Z 0 block-relay-only anchors will be tried for connections.    2023-02-09T02:34:39Z init message: Starting network threads…    2023-02-09T02:34:39Z DNS seeding disabled    2023-02-09T02:34:39Z net thread start    2023-02-09T02:34:39Z addcon thread start    2023-02-09T02:34:39Z opencon thread start    2023-02-09T02:34:39Z init message: Done loading    2023-02-09T02:34:39Z msghand thread start",
  "score": 0,
  "upvotes": 0,
  "downvotes": 0,
  "url": "https://bitcointalk.org/index.php?topic=5438996",
  "comments": [
    {
      "author": "nc50lc",
      "created_time": "February 09, 2023, 07:21:56 AM",
      "body": "Probably not related to the issue but you have a typo in your config:Quote from: Bitcoiner317 on February 09, 2023, 03:20:56 AMCode:    # Needed for full validation    addumevalid=0-snip-Code:    2023-02-09T02:34:22Z Ignoring unknown configuration value addumevalidShould be assumevalid=0Which resulted in skipped signatures verification of blocks older than height 751565.",
      "score": 0,
      "upvotes": 0,
      "downvotes": 0
    },
    {
      "author": "NotATether",
      "created_time": "February 09, 2023, 11:25:31 AM",
      "body": "Check if your proxy is down. You're using only Tor, so make sure you can still connect to that. If you can, check if you have any peers - maybe there are no Tor v3 peers for your node, although I would be baffled if that is indeed the case.Quote from: nc50lc on February 09, 2023, 07:21:56 AMProbably not related to the issue but you have a typo in your config:Quote from: Bitcoiner317 on February 09, 2023, 03:20:56 AMCode:    # Needed for full validation    addumevalid=0-snip-Code:    2023-02-09T02:34:22Z Ignoring unknown configuration value addumevalidShould be assumevalid=0Which resulted in skipped signatures verification of blocks older than height 751565.The assumevalid block is a moving target that is changed during releases, so it is not guaranteed to stay at this block for the next version of Bitcoin.",
      "score": 0,
      "upvotes": 0,
      "downvotes": 0
    },
    {
      "author": "DaveF",
      "created_time": "February 09, 2023, 12:38:27 PM",
      "body": "Quote from: ETFbitcoin on February 09, 2023, 12:08:16 PMThe debug.log seems to be incomplete since it doesn't log any connection problem (e.g. cannot connect to proxy or to other node). You should check your system log and see message which generated by Tor.Quote from: NotATether on February 09, 2023, 11:25:31 AMIf you can, check if you have any peers - maybe there are no Tor v3 peers for your node, although I would be baffled if that is indeed the case.debug.log file state peers.dat has 57414 addresses, so IMO it's very unlikely. Although OP can add node which use .onion link from https://github.com/bitcoin/bitcoin/blob/master/contrib/seeds/nodes_main.txt#L781-L792Does not mean that it can reach those nodes.OP, can you check https://bitnodes.io to see if it sees your node.Bitnodes is NOT A PERFECT test. But if it sees it and you are not updating it's probably on your side since it can be seen.If bitnodes does not see it, then it could be it just does not see it. Other nodes might. And, since you were experimenting with the OS, when did you notice that it stopped working vs what were some of the last changes you made?-Dave",
      "score": 0,
      "upvotes": 0,
      "downvotes": 0
    },
    {
      "author": "Bitcoiner317",
      "created_time": "February 09, 2023, 01:12:32 PMLast edit: February 09, 2023, 02:49:40 PM by Bitcoiner317",
      "body": "Quote from: nc50lc on February 09, 2023, 07:21:56 AMProbably not related to the issue but you have a typo in your config:Thanks!Quote from: NotATether on February 09, 2023, 11:25:31 AMCheck if your proxy is down. You're using only Tor, so make sure you can still connect to that. When listing system services, it seems tor.service is active but tor@default.service returned as loaded but FAILED.But I can't seem to figure out what went wrong..I get the following under journalctl -xeu tor@default.serviceQuoteFeb 09 07:51:35 Anonymous-Laptop systemd[1]: Failed to start Anonymizing overlay network for TCP.And the following under sudo journalctl -u tor@default.serviceAt this point, I assume I just didn't config the TOR service properly. I don't remember setting it up, actually - just installing.Would anyone mind pointing me to a good guide? Thank you!QuoteJan 02 22:32:30 Anonymous-Laptop systemd[1]: Starting Anonymizing overlay network for TCP...Jan 02 22:32:30 Anonymous-Laptop tor[4845]: Jan 02 22:32:30.572 [notice] Tor 0.4.6.10 running on Linux with Libevent 2.1.12-stable, OpenSSL 3.0.2, Zlib 1.2.11, Liblzma 5.2.5, Libzstd 1.4.8 and Glibc 2.35 as libc.Jan 02 22:32:30 Anonymous-Laptop tor[4845]: Jan 02 22:32:30.573 [notice] Tor can't help you if you use it wrong! Learn how to be safe at https://support.torproject.org/faq/staying-anonymous/Jan 02 22:32:30 Anonymous-Laptop tor[4845]: Jan 02 22:32:30.573 [notice] Read configuration file \"/usr/share/tor/tor-service-defaults-torrc\".Jan 02 22:32:30 Anonymous-Laptop tor[4845]: Jan 02 22:32:30.574 [notice] Read configuration file \"/etc/tor/torrc\".Jan 02 22:32:30 Anonymous-Laptop tor[4845]: Configuration was validJan 02 22:32:30 Anonymous-Laptop tor[4854]: Jan 02 22:32:30.778 [notice] Tor 0.4.6.10 running on Linux with Libevent 2.1.12-stable, OpenSSL 3.0.2, Zlib 1.2.11, Liblzma 5.2.5, Libzstd 1.4.8 and Glibc 2.35 as libc.Jan 02 22:32:30 Anonymous-Laptop tor[4854]: Jan 02 22:32:30.778 [notice] Tor can't help you if you use it wrong! Learn how to be safe at https://support.torproject.org/faq/staying-anonymous/Jan 02 22:32:30 Anonymous-Laptop tor[4854]: Jan 02 22:32:30.778 [notice] Read configuration file \"/usr/share/tor/tor-service-defaults-torrc\".Jan 02 22:32:30 Anonymous-Laptop tor[4854]: Jan 02 22:32:30.778 [notice] Read configuration file \"/etc/tor/torrc\".Jan 02 22:32:30 Anonymous-Laptop tor[4854]: Jan 02 22:32:30.785 [notice] Opening Socks listener on 127.0.0.1:9050Jan 02 22:32:30 Anonymous-Laptop tor[4854]: Jan 02 22:32:30.785 [notice] Opened Socks listener connection (ready) on 127.0.0.1:9050Jan 02 22:32:30 Anonymous-Laptop Tor[4854]: We compiled with OpenSSL 30000020: OpenSSL 3.0.2 15 Mar 2022 and we are running with OpenSSL 30000020: 3.0.2. These two versions should be binary compatible.Jan 02 22:32:30 Anonymous-Laptop Tor[4854]: Tor 0.4.6.10 running on Linux with Libevent 2.1.12-stable, OpenSSL 3.0.2, Zlib 1.2.11, Liblzma 5.2.5, Libzstd 1.4.8 and Glibc 2.35 as libc.Jan 02 22:32:30 Anonymous-Laptop Tor[4854]: Tor can't help you if you use it wrong! Learn how to be safe at https://support.torproject.org/faq/staying-anonymous/Jan 02 22:32:30 Anonymous-Laptop Tor[4854]: Read configuration file \"/usr/share/tor/tor-service-defaults-torrc\".Jan 02 22:32:30 Anonymous-Laptop Tor[4854]: Read configuration file \"/etc/tor/torrc\".Jan 02 22:32:30 Anonymous-Laptop Tor[4854]: Opening Socks listener on 127.0.0.1:9050Jan 02 22:32:30 Anonymous-Laptop Tor[4854]: Opened Socks listener connection (ready) on 127.0.0.1:9050Jan 02 22:32:30 Anonymous-Laptop Tor[4854]: Parsing GEOIP IPv4 file /usr/share/tor/geoip.Jan 02 22:32:31 Anonymous-Laptop Tor[4854]: Parsing GEOIP IPv6 file /usr/share/tor/geoip6.",
      "score": 0,
      "upvotes": 0,
      "downvotes": 0
    },
    {
      "author": "nc50lc",
      "created_time": "February 09, 2023, 01:34:34 PM",
      "body": "Quote from: NotATether on February 09, 2023, 11:25:31 AMQuote from: nc50lc on February 09, 2023, 07:21:56 AM-snip-Which resulted in skipped signatures verification of blocks older than height 751565.The assumevalid block is a moving target that is changed during releases, so it is not guaranteed to stay at this block for the next version of Bitcoin.The indicated block height in my reply is based from the \"assumed valid\" block hash in his debug.log entries.",
      "score": 0,
      "upvotes": 0,
      "downvotes": 0
    },
    {
      "author": "Bitcoiner317",
      "created_time": "February 10, 2023, 10:24:14 PM",
      "body": "Alright so I managed to get TOR up and running (glad I had the node issue cause I wouldn't have realized it wasn't running). Core still wouldn't connect to any peer for some reason so I decided to hash out onlynet=onion and it's working now.",
      "score": 0,
      "upvotes": 0,
      "downvotes": 0
    },
    {
      "author": "nc50lc",
      "created_time": "February 11, 2023, 03:07:39 AM",
      "body": "Quote from: Bitcoiner317 on February 10, 2023, 10:24:14 PM-snip- Core still wouldn't connect to any peer for some reason so I decided to hash out onlynet=onion and it's working now. But that essentially enables your node to connect to clearnet, check your peers if all of them have clearnet addresses.If connecting to clearnet isn't an issue, then you're good.",
      "score": 0,
      "upvotes": 0,
      "downvotes": 0
    },
    {
      "author": "Cricktor",
      "created_time": "February 19, 2023, 02:28:02 PM",
      "body": "As you're running Ubuntu: did you install Bitcoin Core as Snap package? Did you install Tor as Snap package?I'm using Ubuntu too, but had issues with Bitcoin Core installed from Snap (\"official\" snap package linked via bitcoincore.org). It simply couldn't properly interact with Tor. (After some digging into possible causes of this issue, it looked to me as a snap packaging problem from Core packaging maintainer(s)). When I discovered this issue, Core v22.0 was the current version. If this snap packaging issue has been resolved or corrected in recent Core version, I can't tell as I didn't look at it anymore.My solution back then was to install Bitcoin Core and Tor *not* from Snap and then it was no problem to configure Tor-only access for Core, no Clearnet necessary if not desired.",
      "score": 0,
      "upvotes": 0,
      "downvotes": 0
    },
    {
      "author": "DireWolfM14",
      "created_time": "February 19, 2023, 06:31:48 PM",
      "body": "Quote from: Bitcoiner317 on February 10, 2023, 10:24:14 PMAlright so I managed to get TOR up and running (glad I had the node issue cause I wouldn't have realized it wasn't running). Core still wouldn't connect to any peer for some reason so I decided to hash out onlynet=onion and it's working now. It might take a several minutes for TOR to spin up and for your node to find onion peers, are you sure you waited long enough?  You can quickly check the status of your Tor proxy with the following command:Code:sudo systemctl status torI'm also curious how you installed TOR.  It's been a while so my memory on the issue is faded, but I tried anonymizing a package (I don't remember which, but it wasn't bitcoin) and had issues with the standard TOR package from the Ubuntu repository.  The standard Ubuntu and Debian apt repositories install an older release of TOR, you can get the latest release by updating your source list.Here's a tutorial on how to set up the Tor Project's official repository: https://support.torproject.org/apt/tor-deb-repo/",
      "score": 0,
      "upvotes": 0,
      "downvotes": 0
    },
    {
      "author": "moijiashiasei",
      "created_time": "June 05, 2023, 09:53:40 AM",
      "body": "could be the case your node was marked as misbehaveadd new nodes and make them priority to connectit usually resolved by itself in 24h",
      "score": 0,
      "upvotes": 0,
      "downvotes": 0
    }
  ]
}